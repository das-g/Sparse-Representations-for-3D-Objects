res = 400

load ../test/cartman.npoff
x = cartman(:,1:2);
x_normals = cartman(:,3:4);
start_sigma = 5;

[mu SIGMA] = EM(x, ...
                'a', 0.0003, ...
                'initial_sigma', start_sigma, ...
                'centers_to_points_ratio', 0.2, ...
                'max_steps', 20, ...
                'input_plot', @(x, SIGMA) scatter(x(:,1),x(:,2)), ...
                'pre_plot', @(mu, SIGMA) plot_gauss_mix( mu, SIGMA, 'res', res ), ...
                'post_plot', @(mu, SIGMA) plot_gauss_mix( mu, SIGMA, 'res', res ));